<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Irc::Bot::Plugins::BotModule
  
    &mdash; Documentation by YARD 0.8.7.6
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../../';
  framesUrl = "../../../frames.html#!Irc/Bot/Plugins/BotModule.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../../_index.html">Index (B)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../Irc.html" title="Irc (module)">Irc</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Bot.html" title="Irc::Bot (class)">Bot</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Plugins.html" title="Irc::Bot::Plugins (module)">Plugins</a></span></span>
     &raquo; 
    <span class="title">BotModule</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: Irc::Bot::Plugins::BotModule
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">Irc::Bot::Plugins::BotModule</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb<span class="defines">,<br />
  /home/apoc/projects/ruby/rbot/lib/rbot/core/utils/extends.rb,<br /> /home/apoc/projects/ruby/rbot/lib/rbot/core/utils/filters.rb</span>
</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>BotModule is the base class for the modules that enhance the rbot</p>

<pre class="code ruby"><code class="ruby">functionality. Rather than subclassing BotModule, however, one should
subclass either CoreBotModule (reserved for system modules) or Plugin
(for user plugins).

A BotModule interacts with Irc events by defining one or more of the following
methods, which get called as appropriate when the corresponding Irc event
happens.

map(template, options)::
map!(template, options)::
   map is the new, cleaner way to respond to specific message formats without
   littering your plugin code with regexps, and should be used instead of
   #register() and #privmsg() (see below) when possible.

   The difference between map and map! is that map! will not register the new
   command as an alternative name for the plugin.

   Examples:

     plugin.map &#39;karmastats&#39;, :action =&gt; &#39;karma_stats&#39;

     # while in the plugin...
     def karma_stats(m, params)
       m.reply &quot;...&quot;
     end

     # the default action is the first component
     plugin.map &#39;karma&#39;

     # attributes can be pulled out of the match string
     plugin.map &#39;karma for :key&#39;
     plugin.map &#39;karma :key&#39;

     # while in the plugin...
     def karma(m, params)
       item = params[:key]
       m.reply &#39;karma for #{item}&#39;
     end

     # you can setup defaults, to make parameters optional
     plugin.map &#39;karma :key&#39;, :defaults =&gt; {:key =&gt; &#39;defaultvalue&#39;}

     # the default auth check is also against the first component
     # but that can be changed
     plugin.map &#39;karmastats&#39;, :auth =&gt; &#39;karma&#39;

     # maps can be restricted to public or private message:
     plugin.map &#39;karmastats&#39;, :private =&gt; false
     plugin.map &#39;karmastats&#39;, :public =&gt; false

   See MessageMapper#map for more information on the template format and the
   allowed options.

listen(UserMessage)::
                       Called for all messages of any type. To
                       differentiate them, use message.kind_of? It&#39;ll be
                       either a PrivMessage, NoticeMessage, KickMessage,
                       QuitMessage, PartMessage, JoinMessage, NickMessage,
                       etc.

ctcp_listen(UserMessage)::
                       Called for all messages that contain a CTCP command.
                       Use message.ctcp to get the CTCP command, and
                       message.message to get the parameter string. To reply,
                       use message.ctcp_reply, which sends a private NOTICE
                       to the sender.

message(PrivMessage)::
                       Called for all PRIVMSG. Hook on this method if you
                       need to handle PRIVMSGs regardless of whether they are
                       addressed to the bot or not, and regardless of

privmsg(PrivMessage)::
                       Called for a PRIVMSG if the first word matches one
                       the plugin #register()ed for. Use m.plugin to get
                       that word and m.params for the rest of the message,
                       if applicable.

unreplied(PrivMessage)::
                       Called for a PRIVMSG which has not been replied to.

notice(NoticeMessage)::
                       Called for all Notices. Please notice that in general
                       should not be replied to.

kick(KickMessage)::
                       Called when a user (or the bot) is kicked from a
                       channel the bot is in.

invite(InviteMessage)::
                       Called when the bot is invited to a channel.

join(JoinMessage)::
                       Called when a user (or the bot) joins a channel

part(PartMessage)::
                       Called when a user (or the bot) parts a channel

quit(QuitMessage)::
                       Called when a user (or the bot) quits IRC

nick(NickMessage)::
                       Called when a user (or the bot) changes Nick
modechange(ModeChangeMessage)::
                       Called when a User or Channel mode is changed
topic(TopicMessage)::
                       Called when a user (or the bot) changes a channel
                       topic

welcome(WelcomeMessage)::
                       Called when the welcome message is received on
                       joining a server succesfully.

motd(MotdMessage)::
                       Called when the Message Of The Day is fully
                       recevied from the server.

connect::              Called when a server is joined successfully, but
                       before autojoin channels are joined (no params)

set_language(String)::
                       Called when the user sets a new language
                       whose name is the given String

save::                 Called when you are required to save your plugin&#39;s
                       state, if you maintain data between sessions

cleanup::              called before your plugin is &quot;unloaded&quot;, prior to a
                       plugin reload or bot quit - close any open
                       files/connections or flush caches here</code></pre>


  </div>
</div>
<div class="tags">
  

</div><div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><span class='object_link'><a href="CoreBotModule.html" title="Irc::Bot::Plugins::CoreBotModule (class)">CoreBotModule</a></span>, <span class='object_link'><a href="Plugin.html" title="Irc::Bot::Plugins::Plugin (class)">Plugin</a></span></p>
</div>




  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#bot-instance_method" title="#bot (instance method)">- (Object) <strong>bot</strong> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>the associated bot.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#handler-instance_method" title="#handler (instance method)">- (Object) <strong>handler</strong> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>the message map handler.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#registry-instance_method" title="#registry (instance method)">- (Object) <strong>registry</strong> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>the plugin registry.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#botmodule_class-instance_method" title="#botmodule_class (instance method)">- (Object) <strong>botmodule_class</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the symbol :BotModule.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#call_event-instance_method" title="#call_event (instance method)">- (Object) <strong>call_event</strong>(ev, *args) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Signal to other BotModules that an even happened.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cleanup-instance_method" title="#cleanup (instance method)">- (Object) <strong>cleanup</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Method called to cleanup before the plugin is unloaded.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#datafile-instance_method" title="#datafile (instance method)">- (Object) <strong>datafile</strong>(*fname) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Filename for a datafile built joining the botclass, plugin dirname and
actual file name.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#default_auth-instance_method" title="#default_auth (instance method)">- (Object) <strong>default_auth</strong>(cmd, val, chan = &quot;*&quot;) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Sets the default auth for command path <em>cmd</em> to <em>val</em> on
channel <em>chan</em>: usually <em>chan</em> is either “*” for everywhere,
public and private (in which case it can be omitted) or “?” for private
communications.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#define_filter-instance_method" title="#define_filter (instance method)">- (Object) <strong>define_filter</strong>(filter, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>define a filter defaulting to the default filter group for this BotModule.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#dirname-instance_method" title="#dirname (instance method)">- (Object) <strong>dirname</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Directory name to be joined to the botclass to access data files.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#do_map-instance_method" title="#do_map (instance method)">- (Object) <strong>do_map</strong>(silent, *args) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Auxiliary method called by #map and #map!.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#fake_message-instance_method" title="#fake_message (instance method)">- (Object) <strong>fake_message</strong>(string, opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Sometimes plugins need to create a new fake message based on an existing
message: for example, this is done by alias, linkbot, reaction and
remotectl.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#filter_group-instance_method" title="#filter_group (instance method)">- (Object) <strong>filter_group</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>read accessor for the default filter group for this BotModule.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#filter_group%3D-instance_method" title="#filter_group= (instance method)">- (Object) <strong>filter_group=</strong>(name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>write accessor for the default filter group for this BotModule.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#flush_registry-instance_method" title="#flush_registry (instance method)">- (Object) <strong>flush_registry</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Method called to flush the registry, thus ensuring that the botmodule&#39;s
permanent data is committed to disk.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#handle-instance_method" title="#handle (instance method)">- (Object) <strong>handle</strong>(m) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Handle an Irc::PrivMessage for which this BotModule has a map.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#help-instance_method" title="#help (instance method)">- (Object) <strong>help</strong>(plugin, topic) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return a help string for your module.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (BotModule) <strong>initialize</strong> </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Initialise your bot module.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_filters-instance_method" title="#load_filters (instance method)">- (Object) <strong>load_filters</strong>(options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>load filters associated with the BotModule by looking in the path(s)
specified by the :path option, defaulting to * Config::datadir/filters/.rb
* botclass/filters/.rb (note that as  we use #dirname() rather than
#name(), since we&#39;re looking for datafiles; this is only relevant for
the very few plugins whose dirname differs from name).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#map-instance_method" title="#map (instance method)">- (Object) <strong>map</strong>(*args) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>call-seq: map(template, options).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#map%21-instance_method" title="#map! (instance method)">- (Object) <strong>map!</strong>(*args) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>call-seq: map!(template, options).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#name-instance_method" title="#name (instance method)">- (Object) <strong>name</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return an identifier for this plugin, defaults to a list of the message
prefixes handled (used for error messages etc).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#priority-instance_method" title="#priority (instance method)">- (Object) <strong>priority</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Changing the value of @priority directly will cause problems, Please use
priority=.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#priority%3D-instance_method" title="#priority= (instance method)">- (Object) <strong>priority=</strong>(prio) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Define the priority of the module.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#propose_default_path-instance_method" title="#propose_default_path (instance method)">- (Object) <strong>propose_default_path</strong>(cmd) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Gets the default command path which would be given to command <em>cmd</em>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#register-instance_method" title="#register (instance method)">- (Object) <strong>register</strong>(cmd, opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Register the plugin as a handler for messages prefixed <em>cmd</em>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_s-instance_method" title="#to_s (instance method)">- (Object) <strong>to_s</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Just calls name.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_sym-instance_method" title="#to_sym (instance method)">- (Object) <strong>to_sym</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Intern the name.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#usage-instance_method" title="#usage (instance method)">- (Object) <strong>usage</strong>(m, params = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Default usage method provided as a utility for simple plugins.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Irc::Bot::Plugins::BotModule (class)">BotModule</a></span></tt>) <strong>initialize</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Initialise your bot module. Always call super if you override this method,
as important variables are set up for you:</p>
<dl class="rdoc-list note-list"><dt>@bot
<dd>
<p>the rbot instance</p>
</dd><dt>@registry
<dd>
<p>the botmodule&#39;s registry, which can be used to store permanent data
(see Registry::Accessor for additional documentation)</p>
</dd></dl>

<p>Other instance variables which are defined and should not be overwritten
byt the user, but aren&#39;t usually accessed directly, are:</p>
<dl class="rdoc-list note-list"><dt>@manager
<dd>
<p>the plugins manager instance</p>
</dd><dt>@botmodule_triggers
<dd>
<p>an Array of words this plugin #register()ed itself for</p>
</dd><dt>@handler
<dd>
<p>the MessageMapper that handles this plugin&#39;s maps</p>
</dd></dl>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


182
183
184
185
186
187
188
189
190
191
192
193
194
195
196</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb', line 182</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>
  <span class='ivar'>@manager</span> <span class='op'>=</span> <span class='const'>Plugins</span><span class='op'>::</span><span class='id identifier rubyid_manager'>manager</span>
  <span class='ivar'>@bot</span> <span class='op'>=</span> <span class='ivar'>@manager</span><span class='period'>.</span><span class='id identifier rubyid_bot'>bot</span>
  <span class='ivar'>@priority</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='ivar'>@botmodule_triggers</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='ivar'>@handler</span> <span class='op'>=</span> <span class='const'>MessageMapper</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
  <span class='ivar'>@registry</span> <span class='op'>=</span> <span class='ivar'>@bot</span><span class='period'>.</span><span class='id identifier rubyid_registry_factory'>registry_factory</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='ivar'>@bot</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^.*::</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>

  <span class='ivar'>@manager</span><span class='period'>.</span><span class='id identifier rubyid_add_botmodule'>add_botmodule</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>set_language</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_set_language'>set_language</span><span class='lparen'>(</span><span class='ivar'>@bot</span><span class='period'>.</span><span class='id identifier rubyid_lang'>lang</span><span class='period'>.</span><span class='id identifier rubyid_language'>language</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="bot-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>bot</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>the associated bot</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


155
156
157</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb', line 155</span>

<span class='kw'>def</span> <span class='id identifier rubyid_bot'>bot</span>
  <span class='ivar'>@bot</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="handler-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>handler</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>the message map handler</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


161
162
163</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb', line 161</span>

<span class='kw'>def</span> <span class='id identifier rubyid_handler'>handler</span>
  <span class='ivar'>@handler</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="registry-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>registry</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>the plugin registry</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


158
159
160</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb', line 158</span>

<span class='kw'>def</span> <span class='id identifier rubyid_registry'>registry</span>
  <span class='ivar'>@registry</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="botmodule_class-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>botmodule_class</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the symbol :BotModule</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


205
206
207</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb', line 205</span>

<span class='kw'>def</span> <span class='id identifier rubyid_botmodule_class'>botmodule_class</span>
  <span class='symbol'>:BotModule</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="call_event-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>call_event</strong>(ev, *args) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Signal to other BotModules that an even happened.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


236
237
238</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb', line 236</span>

<span class='kw'>def</span> <span class='id identifier rubyid_call_event'>call_event</span><span class='lparen'>(</span><span class='id identifier rubyid_ev'>ev</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='ivar'>@bot</span><span class='period'>.</span><span class='id identifier rubyid_plugins'>plugins</span><span class='period'>.</span><span class='id identifier rubyid_delegate'>delegate</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>event_</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_ev'>ev</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>[^\w\?!]+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='op'>*</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cleanup-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>cleanup</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Method called to cleanup before the plugin is unloaded. If you overload
this method to handle additional cleanup tasks, remember to call super() so
that the default cleanup actions are taken care of as well.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


221
222
223
224</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb', line 221</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cleanup'>cleanup</span>
  <span class='comment'># debug &quot;Closing #{@registry}&quot;
</span>  <span class='ivar'>@registry</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="datafile-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>datafile</strong>(*fname) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Filename for a datafile built joining the botclass, plugin dirname and
actual file name</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


375
376
377</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb', line 375</span>

<span class='kw'>def</span> <span class='id identifier rubyid_datafile'>datafile</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_fname'>fname</span><span class='rparen'>)</span>
  <span class='ivar'>@bot</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span> <span class='id identifier rubyid_dirname'>dirname</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_fname'>fname</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="default_auth-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>default_auth</strong>(cmd, val, chan = &quot;*&quot;) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Sets the default auth for command path <em>cmd</em> to <em>val</em> on
channel <em>chan</em>: usually <em>chan</em> is either “*” for everywhere,
public and private (in which case it can be omitted) or “?” for private
communications</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


277
278
279
280
281
282
283
284
285</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb', line 277</span>

<span class='kw'>def</span> <span class='id identifier rubyid_default_auth'>default_auth</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='id identifier rubyid_val'>val</span><span class='comma'>,</span> <span class='id identifier rubyid_chan'>chan</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_cmd'>cmd</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_cmd'>cmd</span>
  <span class='kw'>end</span>
  <span class='const'>Auth</span><span class='op'>::</span><span class='id identifier rubyid_defaultbotuser'>defaultbotuser</span><span class='period'>.</span><span class='id identifier rubyid_set_default_permission'>set_default_permission</span><span class='lparen'>(</span><span class='id identifier rubyid_propose_default_path'>propose_default_path</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_val'>val</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="define_filter-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>define_filter</strong>(filter, &amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>define a filter defaulting to the default filter group for this BotModule</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


166
167
168</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/core/utils/filters.rb', line 166</span>

<span class='kw'>def</span> <span class='id identifier rubyid_define_filter'>define_filter</span><span class='lparen'>(</span><span class='id identifier rubyid_filter'>filter</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='ivar'>@bot</span><span class='period'>.</span><span class='id identifier rubyid_register_filter'>register_filter</span><span class='lparen'>(</span><span class='id identifier rubyid_filter'>filter</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_filter_group'>filter_group</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="dirname-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>dirname</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Directory name to be joined to the botclass to access data files. By
default this is the plugin name itself, but may be overridden, for example
by plugins that share their datafiles or for backwards compatibilty</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


369
370
371</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb', line 369</span>

<span class='kw'>def</span> <span class='id identifier rubyid_dirname'>dirname</span>
  <span class='id identifier rubyid_name'>name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="do_map-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>do_map</strong>(silent, *args) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Auxiliary method called by #map and #map!</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


259
260
261
262
263
264
265
266
267
268
269
270
271</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb', line 259</span>

<span class='kw'>def</span> <span class='id identifier rubyid_do_map'>do_map</span><span class='lparen'>(</span><span class='id identifier rubyid_silent'>silent</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='ivar'>@handler</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='comment'># register this map
</span>  <span class='id identifier rubyid_map'>map</span> <span class='op'>=</span> <span class='ivar'>@handler</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
  <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_map'>map</span><span class='period'>.</span><span class='id identifier rubyid_items'>items</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_register'>register</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='symbol'>:auth</span> <span class='op'>=&gt;</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='symbol'>:hidden</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_silent'>silent</span>
  <span class='ivar'>@manager</span><span class='period'>.</span><span class='id identifier rubyid_register_map'>register_map</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_map'>map</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>privmsg</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_privmsg'>privmsg</span><span class='lparen'>(</span><span class='id identifier rubyid_m'>m</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>      <span class='id identifier rubyid_handle'>handle</span><span class='lparen'>(</span><span class='id identifier rubyid_m'>m</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="fake_message-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>fake_message</strong>(string, opts = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Sometimes plugins need to create a new fake message based on an existing
message: for example, this is done by alias, linkbot, reaction and
remotectl.</p>

<p>This method simplifies the message creation, including a recursion depth
check.</p>

<p>In the options you can specify the :bot, the :server, the :source, the
:target, the message :class and whether or not to :delegate. To initialize
these entries from an existing message, you can use :from</p>

<p>Additionally, if :from is given, the reply method of created message is
overriden to reply to :from instead. The #in_thread attribute for created
mesage is also copied from :from</p>

<p>If you don&#39;t specify a :from you should specify a :source.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="RecurseTooDeep.html" title="Irc::Bot::Plugins::RecurseTooDeep (class)">RecurseTooDeep</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/core/utils/extends.rb', line 505</span>

<span class='kw'>def</span> <span class='id identifier rubyid_fake_message'>fake_message</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_from'>from</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:from</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_o'>o</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='symbol'>:bot</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_from'>from</span><span class='period'>.</span><span class='id identifier rubyid_bot'>bot</span><span class='comma'>,</span> <span class='symbol'>:server</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_from'>from</span><span class='period'>.</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='symbol'>:source</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_from'>from</span><span class='period'>.</span><span class='id identifier rubyid_source'>source</span><span class='comma'>,</span>
      <span class='symbol'>:target</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_from'>from</span><span class='period'>.</span><span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='symbol'>:class</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_from'>from</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='comma'>,</span> <span class='symbol'>:delegate</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
      <span class='symbol'>:depth</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_from'>from</span><span class='period'>.</span><span class='id identifier rubyid_recurse_depth'>recurse_depth</span> <span class='op'>+</span> <span class='int'>1</span>
    <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_o'>o</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='symbol'>:bot</span> <span class='op'>=&gt;</span> <span class='ivar'>@bot</span><span class='comma'>,</span> <span class='symbol'>:server</span> <span class='op'>=&gt;</span> <span class='ivar'>@bot</span><span class='period'>.</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='symbol'>:target</span> <span class='op'>=&gt;</span> <span class='ivar'>@bot</span><span class='period'>.</span><span class='id identifier rubyid_myself'>myself</span><span class='comma'>,</span>
      <span class='symbol'>:class</span> <span class='op'>=&gt;</span> <span class='const'>PrivMessage</span><span class='comma'>,</span> <span class='symbol'>:delegate</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='symbol'>:depth</span> <span class='op'>=&gt;</span> <span class='int'>1</span>
    <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>RecurseTooDeep</span> <span class='kw'>if</span> <span class='id identifier rubyid_o'>o</span><span class='lbracket'>[</span><span class='symbol'>:depth</span><span class='rbracket'>]</span> <span class='op'>&gt;</span> <span class='const'>MAX_RECURSE_DEPTH</span>
  <span class='id identifier rubyid_new_m'>new_m</span> <span class='op'>=</span> <span class='id identifier rubyid_o'>o</span><span class='lbracket'>[</span><span class='symbol'>:class</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_o'>o</span><span class='lbracket'>[</span><span class='symbol'>:bot</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_o'>o</span><span class='lbracket'>[</span><span class='symbol'>:server</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_o'>o</span><span class='lbracket'>[</span><span class='symbol'>:source</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_o'>o</span><span class='lbracket'>[</span><span class='symbol'>:target</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_new_m'>new_m</span><span class='period'>.</span><span class='id identifier rubyid_recurse_depth'>recurse_depth</span> <span class='op'>=</span> <span class='id identifier rubyid_o'>o</span><span class='lbracket'>[</span><span class='symbol'>:depth</span><span class='rbracket'>]</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_from'>from</span>
    <span class='comment'># the created message will reply to the originating message, but we
</span>    <span class='comment'># must remember to set &#39;replied&#39; on the fake message too, to
</span>    <span class='comment'># prevent infinite loops that could be created for example with the reaction
</span>    <span class='comment'># plugin by setting up a reaction to ping with cmd:ping
</span>    <span class='kw'>class</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_new_m'>new_m</span>
      <span class='kw'>self</span>
    <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='symbol'>:define_method</span><span class='comma'>,</span> <span class='symbol'>:reply</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='op'>|</span>
      <span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>replying to &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_from'>from</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; with </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_from'>from</span><span class='period'>.</span><span class='id identifier rubyid_reply'>reply</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_new_m'>new_m</span><span class='period'>.</span><span class='id identifier rubyid_replied'>replied</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>end</span>
    <span class='comment'># the created message will follow originating message&#39;s in_thread
</span>    <span class='id identifier rubyid_new_m'>new_m</span><span class='period'>.</span><span class='id identifier rubyid_in_thread'>in_thread</span> <span class='op'>=</span> <span class='id identifier rubyid_from'>from</span><span class='period'>.</span><span class='id identifier rubyid_in_thread'>in_thread</span> <span class='kw'>if</span> <span class='id identifier rubyid_from'>from</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:in_thread</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_new_m'>new_m</span> <span class='kw'>unless</span> <span class='id identifier rubyid_o'>o</span><span class='lbracket'>[</span><span class='symbol'>:delegate</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_method'>method</span> <span class='op'>=</span> <span class='id identifier rubyid_o'>o</span><span class='lbracket'>[</span><span class='symbol'>:class</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^Irc::|Message$</span><span class='regexp_end'>/</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
  <span class='id identifier rubyid_method'>method</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>privmsg</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_method'>method</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>priv</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_o'>o</span><span class='lbracket'>[</span><span class='symbol'>:bot</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_plugins'>plugins</span><span class='period'>.</span><span class='id identifier rubyid_irc_delegate'>irc_delegate</span><span class='lparen'>(</span><span class='id identifier rubyid_method'>method</span><span class='comma'>,</span> <span class='id identifier rubyid_new_m'>new_m</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="filter_group-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>filter_group</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>read accessor for the default filter group for this BotModule</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


155
156
157</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/core/utils/filters.rb', line 155</span>

<span class='kw'>def</span> <span class='id identifier rubyid_filter_group'>filter_group</span>
  <span class='ivar'>@filter_group</span> <span class='op'>||=</span> <span class='id identifier rubyid_name'>name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="filter_group=-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>filter_group=</strong>(name) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>write accessor for the default filter group for this BotModule</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


160
161
162</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/core/utils/filters.rb', line 160</span>

<span class='kw'>def</span> <span class='id identifier rubyid_filter_group='>filter_group=</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='ivar'>@filter_group</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="flush_registry-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>flush_registry</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Method called to flush the registry, thus ensuring that the botmodule&#39;s
permanent data is committed to disk</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


212
213
214
215</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb', line 212</span>

<span class='kw'>def</span> <span class='id identifier rubyid_flush_registry'>flush_registry</span>
  <span class='comment'># debug &quot;Flushing #{@registry}&quot;
</span>  <span class='ivar'>@registry</span><span class='period'>.</span><span class='id identifier rubyid_flush'>flush</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="handle-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>handle</strong>(m) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Handle an Irc::PrivMessage for which this BotModule has a map. The method
is called automatically and there is usually no need to call it explicitly.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


230
231
232</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb', line 230</span>

<span class='kw'>def</span> <span class='id identifier rubyid_handle'>handle</span><span class='lparen'>(</span><span class='id identifier rubyid_m'>m</span><span class='rparen'>)</span>
  <span class='ivar'>@handler</span><span class='period'>.</span><span class='id identifier rubyid_handle'>handle</span><span class='lparen'>(</span><span class='id identifier rubyid_m'>m</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="help-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>help</strong>(plugin, topic) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return a help string for your module. For complex modules, you may wish to
break your help into topics, and return a list of available topics if
<code>topic</code> is nil. <code>plugin</code> is passed containing the
matching prefix for this message - if your plugin handles multiple
prefixes, make sure you return the correct help for the prefix requested</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


313
314
315</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb', line 313</span>

<span class='kw'>def</span> <span class='id identifier rubyid_help'>help</span><span class='lparen'>(</span><span class='id identifier rubyid_plugin'>plugin</span><span class='comma'>,</span> <span class='id identifier rubyid_topic'>topic</span><span class='rparen'>)</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no help</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_filters-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>load_filters</strong>(options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>load filters associated with the BotModule by looking in the path(s)
specified by the :path option, defaulting to</p>
<ul><li>
<p>Config::datadir/filters/&lt;name&gt;.rb</p>
</li><li>
<p>botclass/filters/&lt;name&gt;.rb</p>
</li></ul>

<p>(note that as &lt;name&gt; we use #dirname() rather than #name(), since
we&#39;re looking for datafiles; this is only relevant for the very few
plugins whose dirname differs from name)</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/core/utils/filters.rb', line 177</span>

<span class='kw'>def</span> <span class='id identifier rubyid_load_filters'>load_filters</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:path</span><span class='rbracket'>]</span>
  <span class='kw'>when</span> <span class='kw'>nil</span>
    <span class='id identifier rubyid_us'>us</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_dirname'>dirname</span><span class='embexpr_end'>}</span><span class='tstring_content'>.rb</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_paths'>paths</span> <span class='op'>=</span> <span class='lbracket'>[</span>
      <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='const'>Config</span><span class='op'>::</span><span class='id identifier rubyid_datadir'>datadir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>filters</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_us'>us</span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='ivar'>@bot</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>filters</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_us'>us</span><span class='rparen'>)</span>
    <span class='rbracket'>]</span>
  <span class='kw'>when</span> <span class='const'>Array</span>
    <span class='id identifier rubyid_paths'>paths</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:path</span><span class='rbracket'>]</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_paths'>paths</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:path</span><span class='rbracket'>]</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_paths'>paths</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_file'>file</span><span class='op'>|</span>
    <span class='id identifier rubyid_instance_eval'>instance_eval</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="map-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>map</strong>(*args) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>call-seq: map(template, options)</p>

<p>This is the preferred way to register the BotModule so that it responds to
appropriately-formed messages on Irc.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


245
246
247</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb', line 245</span>

<span class='kw'>def</span> <span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_do_map'>do_map</span><span class='lparen'>(</span><span class='kw'>false</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="map!-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>map!</strong>(*args) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>call-seq: map!(template, options)</p>

<p>This is the same as map but doesn&#39;t register the new command as an
alternative name for the plugin.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


254
255
256</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb', line 254</span>

<span class='kw'>def</span> <span class='id identifier rubyid_map!'>map!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_do_map'>do_map</span><span class='lparen'>(</span><span class='kw'>true</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="name-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>name</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return an identifier for this plugin, defaults to a list of the message
prefixes handled (used for error messages etc)</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


294
295
296</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb', line 294</span>

<span class='kw'>def</span> <span class='id identifier rubyid_name'>name</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^#&lt;module:.*?&gt;::</span><span class='regexp_end'>/</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(plugin|module)?$</span><span class='regexp_end'>/</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="priority-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>priority</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Changing the value of @priority directly will cause problems, Please use
priority=.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


200
201
202</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb', line 200</span>

<span class='kw'>def</span> <span class='id identifier rubyid_priority'>priority</span>
  <span class='ivar'>@priority</span> <span class='op'>||=</span> <span class='int'>1</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="priority=-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>priority=</strong>(prio) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Define the priority of the module.  During event delegation, lower priority
modules will be called first.  Default priority is 1</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


358
359
360
361
362
363</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb', line 358</span>

<span class='kw'>def</span> <span class='id identifier rubyid_priority='>priority=</span><span class='lparen'>(</span><span class='id identifier rubyid_prio'>prio</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='ivar'>@priority</span> <span class='op'>!=</span> <span class='id identifier rubyid_prio'>prio</span>
    <span class='ivar'>@priority</span> <span class='op'>=</span> <span class='id identifier rubyid_prio'>prio</span>
    <span class='ivar'>@bot</span><span class='period'>.</span><span class='id identifier rubyid_plugins'>plugins</span><span class='period'>.</span><span class='id identifier rubyid_mark_priorities_dirty'>mark_priorities_dirty</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="propose_default_path-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>propose_default_path</strong>(cmd) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Gets the default command path which would be given to command <em>cmd</em></p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


288
289
290</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb', line 288</span>

<span class='kw'>def</span> <span class='id identifier rubyid_propose_default_path'>propose_default_path</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='rparen'>)</span>
  <span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_cmd'>cmd</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="register-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>register</strong>(cmd, opts = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Register the plugin as a handler for messages prefixed <em>cmd</em>.</p>

<p>This can be called multiple times for a plugin to handle multiple message
prefixes.</p>

<p>This command is now superceded by the #map() command, which should be used
instead whenever possible.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


325
326
327
328
329
330
331
332
333
334
335
336
337
338</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb', line 325</span>

<span class='kw'>def</span> <span class='id identifier rubyid_register'>register</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Second argument must be a hash!</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_who'>who</span> <span class='op'>=</span> <span class='ivar'>@manager</span><span class='period'>.</span><span class='id identifier rubyid_who_handles?'>who_handles?</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_who'>who</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Command </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cmd'>cmd</span><span class='embexpr_end'>}</span><span class='tstring_content'> is already handled by </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_who'>who</span><span class='period'>.</span><span class='id identifier rubyid_botmodule_class'>botmodule_class</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_who'>who</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_who'>who</span> <span class='op'>!=</span> <span class='kw'>self</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='symbol'>:auth</span><span class='rparen'>)</span>
    <span class='ivar'>@manager</span><span class='period'>.</span><span class='id identifier rubyid_register'>register</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:auth</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='ivar'>@manager</span><span class='period'>.</span><span class='id identifier rubyid_register'>register</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='id identifier rubyid_propose_default_path'>propose_default_path</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='ivar'>@botmodule_triggers</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_cmd'>cmd</span> <span class='kw'>unless</span> <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:hidden</span><span class='comma'>,</span> <span class='kw'>false</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_s-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>to_s</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Just calls name</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


299
300
301</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb', line 299</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_s'>to_s</span>
  <span class='id identifier rubyid_name'>name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_sym-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>to_sym</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Intern the name</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


304
305
306</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb', line 304</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_sym'>to_sym</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="usage-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>usage</strong>(m, params = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Default usage method provided as a utility for simple plugins. The
MessageMapper uses &#39;usage&#39; as its default fallback method.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


343
344
345
346
347
348
349
350
351
352
353
354</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/apoc/projects/ruby/rbot/lib/rbot/plugins.rb', line 343</span>

<span class='kw'>def</span> <span class='id identifier rubyid_usage'>usage</span><span class='lparen'>(</span><span class='id identifier rubyid_m'>m</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:failures</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span> <span class='symbol'>:find</span>
    <span class='id identifier rubyid_friendly'>friendly</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:failures</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
      <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span> <span class='const'>MessageMapper</span><span class='op'>::</span><span class='const'>FriendlyFailure</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_friendly'>friendly</span>
      <span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_reply'>reply</span> <span class='id identifier rubyid_friendly'>friendly</span><span class='period'>.</span><span class='id identifier rubyid_friendly'>friendly</span>
      <span class='kw'>return</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_reply'>reply</span><span class='lparen'>(</span><span class='id identifier rubyid__'>_</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>incorrect usage, ask for help using &#39;%{command}&#39;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>%</span> <span class='lbrace'>{</span><span class='symbol'>:command</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@bot</span><span class='period'>.</span><span class='id identifier rubyid_nick'>nick</span><span class='embexpr_end'>}</span><span class='tstring_content'>: help </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_plugin'>plugin</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Mon Mar  9 04:49:03 2015 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.2.0).
</div>

  </body>
</html>